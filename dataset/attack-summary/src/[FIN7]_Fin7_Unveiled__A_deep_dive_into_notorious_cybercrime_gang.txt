FIN7 Unveiled A deep dive into notorious cybercrime gang. This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities. 1Introduction The highly active threat group FIN7 has been continuously broadening their cybercrime horizons and recently added ransomware to its attack arsenal. They are known to hold a notorious status due to their achievement in deploying extensive backdoors in leveraging software supply chains, distributing malicious USB sticks, and cooperating with other groups. Nowadays, its initial approach is to carefully pick high-value companies from the pool of already compromised enterprise systems and force them to pay large ransoms to restore their data or seek unique ways to monetize the data and remote access.FIN7 is also attributed[8] to the espionage campaign named Carbanak, and is known to be interacting[3] with other hacker groups well-known under names such as LockBit, Darkside, REvil, or MAZE. Most notably, FIN7 has gathered several uncategorized hacking teams and created fake infosec firms[5] to trick security researchers into executing ransomware attacks by taking on names such as Combi Security and Bastion Secure.From 2013 onwards, the victims ranging from food producers, critical infrastructure providers, to healthcare and financial firms have suffered significant magnitude of financial losses caused by this threat group. While FIN7’s primary objective is to directly steal financial information, they will also steal sensitive information to sell on underground marketplaces, or reuse it in their upcoming ransomware attacks. Moreover, the group appears to be as active as ever, bringing up a relatively greater deal of successful methods on techniques and attack surfaces ; e.g. utilizing the go-to tools called POWERPLANT, rclone, and so on. The group has specialized in PowerShell programs and unique commands that can be observed across malware infections.PRODAFT Intelligence Team (PTI) puts forward the cybercriminal investigation with its visibility into critical elements of FIN7 infrastructure and vital data on its kill chain. On top of that, this report discusses crucial insights of the attack vectors, infection mechanisms and toolkits used by this group to exploit the network from the initial infection, the operational details, and regional distribution.Please note that this report has two versions. The ”Private Release” is provided to law enforcement agencies, applicable CERTS / CSIRTS, and members of our U.S.T.A. Threat Intel Platform (with appropriate annotations and reductions). Likewise, the ”Public Release” is publicly disseminated for the purpose of advancing the global fight against high-end threat actors and APTs.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.3 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gang2 Executive SummaryThis report demonstrates the continuous threat intelligence research carried out by the PRODAFT threat intelligence team (PTI). The main aim is to elaborate on the comprehensive TTP of the APT group known as FIN7. The data captured by the PTI team contains information about attack tools used by the FIN7 group, various backup files, and conversation history. Moreover, in private chats, we identified the inner details of various cyber-attack operations conducted against large institutions based in the USA and Europe.The Organizational Structure section of the report further covers and reveals the FIN7 group hierarchy, disclosing the nicknames and addresses of the members. The group sequence exhibits clear structures distributed into management, developers, penetration testers and affiliate positions, essentially making them study the targets’ internal procedures more efficiently and successfully. PRODAFT is the first organization that gained visibility into the organizational structure of FIN7 and the real identities of some of its members. Furthermore, we share information on their account activities that previously involved illegal operations.During our team’s analysis of Jabber conversation history, we observed that the purpose of these attacks was to infiltrate the target corporation networks and encrypt valuable data to request ransom payments from the institutions. After entering the systems of large to medium-sized organizations, members of the attacker group predominantly deploy Darkside or REvil/Sodinokibi ransomware on victim computers.For the purpose mentioned above, threat actors had mainly exploited well-known Microsoft Exchange vulnerabilities (ProxyShell and ProxyLogon) to gain initial access to their targets due to the availability of easy-to-use public tools. PTI team also identified that the FIN7 group developed tailored systems to quickly discover and infiltrate the high-value targets by performing mass scans.Apart from exploitation to gain initial access, it has been observed that FIN7 also performs social engineering attacks or uses already stolen enterprise credentials. We discovered several methods of their e-mail phishing techniques with malicious document attachments, as briefly analyzed in the corresponding sections of this report. Stolen credentials were found to be purchased from underground markets and checked with in-house developed scripts/tools.The overall tactics and behaviour of the group reveal habitual patterns. After the initial access, FIN7 proceeds with the execution of the rest of the ransomware attack chain, encrypting the files, leaving a note inside the targeted systems and directing the institution’s representatives to the chat platforms hosted inside the TOR network. There they negotiate a ransom payment in cryptocurrency with their victims ; if the institution refuses to pay the ransom money, the attacker group publicly shares the files stolen from target institutions on a website in the TOR network. However, an unusual action after this chain is that they leave an SSH-based backdoor on the target systems. It has been concluded that the objective of this backdoor is to re-target the victims with other types of ransomware to gain more profit, whilst this presumption is echoed by the conversations held among the threat actors.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.4 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangFurthermore, the PTI team has disclosed that the owner of the obtained data is an active member of the FIN7 group who is responsible for providing tailored access to the targeted institutions. The conversation history exposed the fact that the subject threat actor is also providing tailored access to other ransomware distributors.Last but not least, the aforementioned behavioural patterns, tactics, techniques and procedures confirmed that FIN7 attempts to filter and prioritize vulnerable targets in order to minimize their effort and maximize their profit. They are doing so by considering several parameters, such as annual revenue, foundation date, and the number of employees in the company. A specific page discovered in their management panel shows the value of each vulnerable target. This page demonstrates a particular type of feasibility study considered a unique behaviour among cyber-crime groups.The inner workings of FIN7 present an intriguing insight into one of the most notorious and advanced cybercrime groups. All the provided information allows the readers to make further deductions while guiding them with a cohesive, meticulously crafted image.Analyst Note : Although we analyzed millions of lines in Jabber logs, various scripts, and executable files sizing more than a few GBs in total belonging to the FIN7 group, we are still looking for possible collaborations with other threat intelligence teams to go over the remaining parts.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.5 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gang3 The FIN7 Power House : Organizational StructureThe FIN7 team has an interrelated structure that ensures consistent workflow among the team members throughout each operation. In Figure 1, the internal management is demonstrated hierarchically whilst revealing precisely tailored inner structures. Moreover, this section focuses on interactions among the group members and clearly indicates individual responsibilities and practices that each member engages in.Figure 1. FIN7 Team’s Organizational Structure.Analyst Note : The following sections continually show evidence from conversations between threat actors that the PTI team had visibility on. Note that these dialogues are translated (without breaking the slang language as much as possible) from Russian to English for the audience of this report. Feel free to ask any question on the de-anonymized information of specific threat actors.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.6 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gang3.1 Alex : The ManagerAs the employer and leader of the FIN7 group, Alex is a mastermind of infiltration and ransomware attacks on corporations. Known within the group as the employer and leader, he is often referred (as shown in Figure 2) to as such in the group’s Jabber logs. He is heavily involved in the group’s infiltration and ransomware attacks, and plays a key role in the planning and execution of these operations. With his expertise and experience, Alex is a formidable threat actor who poses a significant risk to businesses and organizations.Figure 2. Conversation about FIN7 leader.Following conversation from 2020 indicates that Roland and Shepard have been working for Alex for 2 years.Figure 3. Conversation about FIN7 leader.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.7 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gang3.2 Rash : The Ransomware MastermindBy reviewing the conversation below, it’s been determined that the user with the Rash alias is the manager of Shepard and Roland. Apparently, Rash is the person who is in charge of the Ransomware operations.Figure 4. Statements that showing the position of Rash in the group.Figure 5 demonstrates that people working under the supervision of Rash do not even know the exact amount they earned or how it is shared among themselves. However, it is obvious that Rash takes the bigger piece of the pie.Figure 5. Conversation about Rash’s profit.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.8 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangConversation given in Figure 6 shows that actors prefer using Monero (XMR) instead of BTC. In case a BTC payment is going to be carried out, they try to take care of their anonymity by laundering the relevant crypto money beforehand.Figure 6. Use of Monero (XMR) for payments.Another conversation reveals the fact that license for using the administrator panel is not owned by Rash.Figure 7. Conversation about ransomware panel.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.9 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangFigure 8 shows a message from the user one@protectzoom.com who shares a victim’s stolen credential, which mentions the jnbs.com domain. This victim is known to be attacked by REvil Ransomware on March 14, 2020 1. Roland infiltrated the target with the given information on February 25, 2020, and then exposed the victim’s confidential data in a REvil ransomware blog named Happy Blog.Figure 8. Conversation about one of the REvil Ransomware victims.1. url : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.10 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gang3.3 Sergey-Oleg aka S-O : The Target WatcherSergey-Oleg is a leader within the FIN7 group and is known for his expertise in tailored access operations. He is responsible for assigning tasks to the group’s members (as shown in Figure 9) and overseeing their execution. With his specialized knowledge and skills, Sergey-Oleg plays a critical role in the group’s success and its ability to carry out sophisticated cyberattacks against high-value targets.Figure 9. Conversation about victim’s credentials.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.11 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gang3.4 Derv1sh : The DeveloperAs a result of a thorough investigation by the PTI team, it was determined that the actor known as Derv1sh is a developer for the notorious FIN7 group. A Github page was discovered under the username derv1sh, which contained a number of payloads used by the attacker group. Among these files was the infamous gost.exe, which has been used in a number of high-profile intrusions.Figure 10. GitHub repository of the Derv1sh.3.5 Vie : The VX-MasterVie has been collaborating with Alex for an extended period of time and has contributed to the development of various toolkits, including the Checkpoint Software Loader, which is the team’s primary remote access tool. Vie also played a crucial role in the Carbanak campaign.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.12 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gang3.6 Roland : The GatekeeperAs a result of the threat intelligence studies carried out by the PTI team, it was established that one of the FIN7 pentesters is Ukrainian citizen, with nickname Roland. He uses the aliases seeerega, rol, roland, soslowso on different chat applications, forums and social media platforms. Based on the evidence from Jabber conversations, PTI team concluded that Roland conducts cyber-attacks for various ransomware providers and FIN7 APT group in order to infiltrate and provide tailored access to targeted institutions that are potential ransomware victims.3.7 Shepard : The PentesterAs a result of the analysis, it was clear that Shepard, like Roland, was engaged in a pentest for Alex and Rush. It is understood from the related past speeches that these people reside in Ukraine. Hryvnia, the Ukrainian currency, is mentioned as a possible form of payment to buy a laptop device.Figure 11. Converting dollar currency into hryvnia for laptop.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.13 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gang4 Technical AnalysisThe FIN7 group is known for their highly sophisticated and targeted attacks. In this section, we will uncover the methods and tools used by the FIN7 team to carry out their operations. This includes details on their infrastructure, attack arsenal, communication environment, initial vectors, and post-exploitation techniques. We will also discuss one of their most notable campaigns and the impact they have had on organizations around the world.4.1Initial VectorsThe FIN7 hacking group often uses custom scripts to exploit public-facing web applications. In conversations between group members as shown in below, they have discussed using the CVE-2020-0688 vulnerability in Microsoft Exchange applications to run arbitrary PowerShell scripts on victims’ servers. This allows them to gain unauthorized access and potentially steal sensitive information.Figure 12. Conversation about the usage of Microsoft Exchange exploit.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.14 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangBefore using the exploit for CVE-2020-0688 vulnerability, the FIN7 group checks whether or not the vulnerability exists on the victim servers. Thereon the PTI team found the README file describing this operation for Exchange servers on detecting vulnerability.Figure 13. README of the script distributed within the team - Translated from Russian.With aforesaid, for using exploit against Exchange vulnerability, this threat group purchases the stolen accounts of OWA on specific internet markets, and examines their validity. A file README is given below with commands of Python-script for checking accounts (see Figure 14).Figure 14. Help page of the script distributed within the team - Translated from Russian.In addition to the CVE-2020-0688 vulnerability, the FIN7 team members were quite interested in other types of Microsoft Exchange exploits, including ProxyLogon, ProxyShell, or CVE-2021-42321. To take advantage of these vulnerabilities, they developed tailored scripts to automate the exploitation process. They customized public exploits and sometimes combined them with zero-day vulnerabilities to create even more effective attacks. It’s likely that they decided to develop a new system to automate this process, and they created the tailored system (as described in Section 4.4) for that purpose. This system allowed them to quickly and efficiently exploit any vulnerable systems they came across.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.15 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangIn addition to exploiting the vulnerabilities mentioned above, FIN7 has also been known to use other attack vectors, such as BadUSB attacks. In March 2020, public reports linked FIN7 to these social engineering attacks, which involve convincing potential victims to plug in USB flash drives containing malicious code into their computers. We observed several BadUSB scripts in the team’s toolkit (as shown in Figure 15) and published technical analysis on some of them 2.Figure 15. Excerpt of the FIN7 Team’s attack arsenal - Ready-to-ship flash drives.In BadUSB attacks, the attacker modifies a USB flash drive to act as a human interface device (HID), such as a keyboard, and use it to input commands into the victim’s machine. In FIN7’s BadUSB attacks, they have been known to modify their USBs to act as a keyboard and simulate keyboard strokes to invoke a malicious Powershell command. However, they recently added a new SSH-based backdoor (as shown in Figure 16) to their arsenal, which allows them to steal confidential files from the target system using reverse SSH connections (SFTP). This adds another layer of sophistication to their attacks and makes it even harder for victims to detect and defend against them.Figure 16. Excerpt of the FIN7 Team’s SSH-based backdoor script.2. url : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.16 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangThe PTI team has detected a dialogue between FIN7 members where they discuss and confirm the use of the BadUSB attack vector. The dialogue (see Figure 17) also explicitly mentions attacks on POS machines and manipulations of international payment systems. From these messages, it appears that Alex is the leader of the FIN7 group, as mentioned in Section 3.1 of this report. This provides further evidence of FIN7’s involvement in these activities and the extent of their capabilities.Figure 17. Conversation about USB flash drives and attacks on POS machines.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.17 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangIn a conversation, two FIN7 team members were discussing their BadUSB attack payloads, which had been obtained by antivirus companies. They mentioned that the payloads were marked as FIN7, which shows that they are aware of and track the activities of security researchers. This level of awareness and tracking suggests a high level of sophistication and dedication to their operations. However, threat intelligence efforts have disrupted their operation and exposed their tactics, making it harder for them to carry out successful attacks.Figure 18. Conversation about USB flash drives and payloads.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.18 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangIn addition to the tactics and techniques they have already been known to use, the PTI team has discovered that FIN7 is also affiliated with ransomware groups such as REvil, LockBit, and Darkside. One of the ways they infiltrate victim networks and subsequently encrypt their devices is by purchasing stolen authentication data, such as VPN, RDP, Firewall, Email accounts and other access types used by enterprises. These accounts are typically stolen by stealer malware and sold on underground markets, where FIN7 and other threat actors can purchase them. This allows them to gain access to a wide range of systems and carry out their attacks more easily.Figure 19. Files containing purchased stolen accounts.The FIN7 group carefully scrutinizes the validity of stolen accounts and uses a service like Zoominfo to select the firms and organizations with the highest revenue. Once they have gained initial access to these systems, they steal and encrypt files, and determine the ransom amount based on the company’s revenue. A sample file containing purchased stolen accounts can be seen in Figure 19. This file gives the threat actors access to all of the victim’s information, including their browser, website URL, username, and password. This allows them to carry out their attacks with precision and maximize their profits.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.19 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangIn order to maintain versatility and ensure access to as many channels as possible, FIN7 also commonly uses spear phishing as an attack vector. The group members distribute spam e-mails by demanding payment with an attached malicious file .docm. This file has a macro script which opens a backdoor in a victim’s device. Figure 20 depicts an example of a phishing text message sent via e-mail in the Italian language. It is translated as, ”Hello, Please pay the invoice ; we have not yet received your payment. If the payment has already been sent, ignore this e-mail. Thank you.”Figure 20. Phishing E-Mail text.When the victim opens the attached document, a legitimate message appears that says ”To see the attached document, click on Enable Content.” This allows the malicious script to be activated on the victim’s computer, opening a backdoor that allows FIN7 to silently gain access. This is a common trick that attackers use to trick victims into enabling the malicious content, allowing them to infect the victim’s device without their knowledge.Figure 21. Malicious .docm file.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.20 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gang4.2 Communication EnvironmentDuring our research on the FIN7 group infrastructure, we identified the team leader’s Jabber address as alxchkpnt@jabberix.com and a Mattermost server named chckpntrecrut that is used for communication within the team, in addition to protectzoom.com. Figure 22 shows a screenshot of one of the threat actors using TeamViewer software to help each other, with the chat server visible in the background. This provides further evidence of the group’s use of these communication channels and the level of coordination among its members.Figure 22. Threat actors helping each other - FIN7 Mattermost Server.In the above screenshot, Roland helps ruben to resolve technical problems. We identified the same nickname in the Conti Ransomware leak published in March 2022 and noticed it among Conti’s internal chat system’s users, as shown in below.Figure 23. User list of the Conti ransomware team’s private chat system.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.21 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gang4.3 Attack ArsenalThroughout our investigation, the FIN7 group consistently used the multi-functional tool known as Carbanak to open backdoors on victim computers. In July 2020, we published a technical analysis 3 of Carbanak version 3.7.4, which was compiled in November 2019 according to the PE file header. The interface of the tool is titled ”Command Manager 3.7.4 - Russian version. Checkpoint Software Inc.” and has capabilities such as port forwarding, RDP/VNC access, command line access, file transfer, and more. As previously mentioned in the report, the keyword ”checkpoint” is often used by Alex (see 3.1), the manager of the FIN7 team. This tool is an important part of FIN7’s arsenal and is used in many of their attacks.Figure 24. Carbanak Client - Command Manager.In addition to using Carbanak, FIN7 threat actors are currently developing a new remote access Trojan (RAT) called Icebot. This new tool has similar capabilities to Carbanak, Lizar, and Tirion and is being tested in their testing environments. We expect it to be widely deployed on victim devices in the future. This indicates that FIN7 is continuously evolving and updating their tactics and tools in order to maintain their ability to carry out successful attacks.Figure 25. Icebot samples that are being tested by threat actors.3. url : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.22 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangOn the other hand, there was another technical analysis by our company regarding a Tirion tool with 1.6.4 version released in July, 2020 which actually got replaced with Carbanak. Over time, the name of this tool has been changed to Lizar version 2.0.4. Based on our our latest discovery, the Lizar has become 2.0.7 and named as Remote System Client. This tool is able to interact with Carbanak Backdoor as displayed in Figure 26.Figure 26. Lizar Client 2.0.7The functions of Tirion/Lizar malware are the following :• Information Gathering • Taking Screenshot • List Running Processes • Command / Code Execution • Active Directory and Network ReconDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.23 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangFIN7 often use tailored, versioned, and highly dynamic PowerShell scripts developed by their own development team to produce executables for the deployment of fresh instances. These scripts, along with instructions and public-private keys, are packaged into a deployment pack (as shown in Figure 27) and distributed among the core team members.Figure 27. Deployment pack of the threat actors.The deployment pack used by threat actors often includes a generic dropper that can be easily integrated with the team’s other arsenal. Some of the file names used in these scripts (see Figure 28), such as ClearTemp.ps1, have been previously mentioned in the public reports of Mandiant 4 and Crowdstrike 5.Figure 28. Generator script of the custom dropper (a.k.a. TAKEOUT).Analyst Note : Due to the limited resources and time constraints, the PTI team is still analyzing the FIN7 group’s entire arsenal. Feel free to ask for samples and source codes to conduct joint research.4. url 5. url : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.24 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangDuring our investigation,we discovered that a person with the nickname ”seeerega aka roland” was responsible for testing and writing the README for the Tirion tool. This provides further evidence of the group’s organizational structure and the roles and responsibilities of its members.Figure 29. Jabber conversation about Tirion.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.25 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gang4.4 Large-Scale Auto-Attack CampaignDuring the investigation, the PTI team noticed a unique system used by the FIN7’s sub-team that targets the Microsoft Exchange servers and other public-facing applications in particular by mass scale scanning. The deeper analysis revealed that the attackers directly scanned and exploited hundreds of Microsoft Exchange servers with Proxyshell (CVE-2021-34473, CVE-2021-34523, and CVE-2021-31207) vulnerabilities.After the Proxyshell vulnerabilities were announced as part of the April 2021 Microsoft Exchange Server Security Updates[4], the first proof-of-concept (POC) examples of these vulnerabilities began to appear in August of that year. Most threat actors, including those deploying LockFile[1], Babuk[6], and QBot[7], first used these vulnerabilities in August and September 2021. However, our team discovered that FIN7’s initial operations using these vulnerabilities started in June 2021, before the public POCs were released. This indicates that FIN7 was actively monitoring the situation and was able to quickly take advantage of these new vulnerabilities to carry out their attacks.Threat actors exploit ProxyShell vulnerabilities to establish remote PowerShell sessions on the vulnerable Exchange Servers. There are several ways that attackers have used the PowerShell to create web shells. Following vulnerabilities are observed to be exploited :that does not require any user action or privilege to exploit ;• CVE-2021-34473 : Microsoft Exchange Server Remote Code Execution(RCE) vulnerability • CVE-2021-34523 : Microsoft Exchange Server Elevation of Privilege Vulnerability after • CVE-2021-31207 : Microsoft Exchange Server security feature bypasses vulnerabilityauthentication ;flaw that allows attackers to gain administrative access.Figure 30. Auto-attack system developed by FIN7 to exploit Exchange vulnerabilities.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.26 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gang4.4.1 Exchange Exploitation ModuleOn June 1, 2021, the FIN7 team created an automated attack system called Checkmarks using the Django framework. They primarily used the system to scan for exchange servers and run Microsoft Exchange exploits on them, as seen in the screenshot in Figure 30. This allowed the team to identify and exploit vulnerabilities in exchange servers worldwide. The below table shows the details of the tailored system.IP addresses to scan the exchange server for OWA files. If an exchange server is detected in any of the domains, the exploit is applied and a shell is dropped over via Powershell. The panel not only performs exploitation, but also provides various details on the victim, as seen in Figure 31.Figure 31. Custom auto-attack system - Victim details.The Traffic Source is where the attack is made, and further it represents ; the exchange vulnerability running status, the Powershell running status, and the shell release status. By looking at these sources, it is understood that the system accepts victim domains mostly from the USA, UK, and CA.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.27 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangThe FIN7 team successfully carried out exchange server attacks in June 2021 using a custom exploit code. However, this exploit was later removed from their panel. After September 4, 2021, they began targeting victims using an open source exploit[2], as seen in the log file in Figure 32. The image below shows a victim that has been successfully scanned and had a Powershell script run on it. When the Proxyshell attack is successful, post-exploitation steps are automatically executed, including extracting all emails from Active Directory (AD) and collecting all Exchange Server information.Figure 32. Custom auto-attack system - Exploit output.After successful exploits are displayed on the main page, the FIN7 actors begin to examine each victim’s domain by filtering them with ’exchange got PS’. Simultaneously, the Pentest and Marketing teams collaborate with FIN7 on sharing information about their victims as shown in Figure 33.Figure 33. Custom auto-attack system - Comments on the victim.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.28 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangThe Marketing team at FIN7 first gathers information on potential victims, including their current revenue, number of employees, headquarter details, domain, and website. They then share this information with the Pentesters to determine if the victim is a worthwhile target. If a firm is deemed to have a sufficient market size, the Pentester leaves a comment for the admin on how the server connection can be used, how long the attack can last, and how far it can go. This information is used to shape the next stages of the attack. This level of planning and coordination is not typical among other cybercrime groups and is a distinct characteristic of FIN7.Figure 34. Custom auto-attack system - Victim prioritization.In the remaining section of the Victim company details page, there is a list of the relevant victims’ AD domains, along with their company URL details and mail information obtained from the exchange server, as seen in Figure 34. If the company meets the criteria for targeting, it will be flagged by the threat actor for the admin to see. This allows the FIN7 team to easily identify and prioritize potential victims.4.4.2 Auto-SQLi ModuleIn addition to the auto-exploitation of Microsoft Exchange vulnerabilities, threat actors also developed a module for the SQL Injection attacks. In cases where an attack does not meet a definitive result and cannot be proceeded within the server, the target victim is marked for scanning by SQLMap tool. Ultimately, all URLs are scanned to acquire if there are any SQL injection vulnerabilities.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.29 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangWhen starting a scan, the OS command parameter is given to SQLMap to collect the tasklist and domain information of the victim, as shown in Figure 35. The system runs automatically and provides remote access to attackers from the victim’s internal system if the attack is successful. Crowdstrike detected the attacks carried out by this system and attributed it to the FIN7 in one of their posts 6.Figure 35. Custom auto-attack system - SQLi Module.The attack outputs show that the FIN7 team uses specific SQLMap configurations within their operations (see Figure 36). The team has designed the system to be highly customizable, allowing them to easily implement new attack modules using different tools like SQLMap. This flexibility allows the team to adapt to different situations and target a wide range of vulnerabilities.Figure 36. Custom auto-attack system - SQLMap parameters.6. url : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.30 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gang4.4.3 Victim PrioritizationThe PTI team has shed light on FIN7’s prioritizing of the companies with the highest revenue to get profitable operations. From their chain attack it is apparent that the company size, revenue, market capitalization and investment are categories that hold the greatest significance in their target selection. The goal is not to attack them all, but to target the companies that will bring them the highest income. Besides the techniques used in high-profile targeting, the threat group worked with many different services to set targets and analyze them as provided with an evidence in Figure 37.Figure 37. Custom auto-attack system - Owler data.As it is attached above in the panel, an Owler Data page is provided with extensive information on target techniques and strategies of FIN7. Internally, they collect and list Private and Public company data over the Owler service, and store the domains, pages, company names, CEO information, CEO’s rating, establishment dates, and company status ; whether Public/Private/Independent among the top companies. Subsequently, an additional Manager comment field is added for FIN7 operators to attack with a written guidance. Altogether, there are 962 main companies in total, including their various subsidiaries, stored with information from collected company data.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.31 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangThe FIN7 group uses various information sources, including Owler Data, to select victims. They maintain a panel of dozens of REST APIs, as shown in Figure 38, which they use to collect diverse information on potential victims. Once they have evaluated the data obtained from services such as DNB, Owler, Zoominfo, and Crunchbase, they can target the victims accordingly. The group also uses services like Similarweb, Mustat, and Alexa to evaluate analytics data including traffic size of victims’ websites.Figure 38. Custom auto-attack system - Multiple enrichment APIs.In order to identify new and potentially vulnerable targets, the FIN7 group uses a variety of Google Dorks keywords to scan the internet. This process is an important part of their system and helps them to find fresh targets for their attack modules.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.32 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gang4.4.4 OperatorsThe primary objective of our investigation was to identify the affiliates, retailers, developers, and servers associated with the FIN7 group. Through extensive analysis, we were able to uncover a wealth of previously unknown information about the group and its technical infrastructure. Our investigation revealed that the auto-attack system is managed by five different actors, each of whom has access to different sections of the panel (see Table 2). The panel appears to have been created by Russian-speaking threat actors, as the original comments are in Russian. The usernames and creation dates are as follows :Username Creation Date (UTC) cto 13.04.2022 08:30:36 13.04.2022 08:31:26 roman 13.04.2022 08:33:41 06.06.2022 12:21:35 06.06.2022 12:22:04 anubisTable 2. Custom auto-attack system - User list.serhii is the nickname of Sergey-Oleg, who was previously mentioned in Section 3.3 as the manager of the FIN7 group. roman is also a member of the team, as shown in the organizational chart (see Section 3). In addition to these usernames, we observed that the system deploys FIN7’s traditional arsenal, including Tirion/Lizar or their SSH-based backdoor, into the victims’ environment, allowing them to maintain access and control.Analyst Note : For the sake of simplicity, we did not include the personal details, real locations, full names and de-anonymized information of the threat actors in this report. Feel free to ask any question on specific threat actors to get more information.All attacks are being carried out through different proxies. Even though the users’ creation dates imply otherwise, the initial attack was conducted on 01.06.2021. Each operation is complemented through the use of the following IP addresses.Country Russia Russia Russia Russia Russia RussiaISP Internet Technologies LLC Internet Technologies LLC Internet Technologies LLC Internet Technologies LLC Internet Technologies LLC Internet Technologies LLC Internet Technologies LLC Internet Technologies LLC Internet Technologies LLCTable 3. Custom auto-attack system - Proxy Servers.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.33 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gang4.5 Post-ExploitationDuring a Jabber conversation (see Figure 39), FIN7 team members discussed the use of Cobalt Strike, a well-known tool used for post-exploitation. Our analysis of their attack arsenal revealed a large number of different Cobalt Strike payloads. These payloads were often combined with PowerShell scripts for added effectiveness.Figure 39. Conversation about the usage of Cobalt-Strike.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.34 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangAfter initially infecting a victim’s device, the FIN7 group mostly uses an SSH-based Backdoor to manage the remote access and transfer files besides Cobalt Strike. This technique is employed on victims who are not infected with ransomware, but rather are part of a cyber-espionage operation. The remote server acts as a proxy, allowing the FIN7 group to operate the SSH connection through an Onion domain, as illustrated in the management commands (translated from Russian) of the SSH-based Backdoor in Figure 40.Figure 40. Management commands of the SSH-based backdoor.Furthermore, the group members of FIN7 use the rclone tool for downloading the big files from the victim’s system to cloud storage such as Mega.nz and Azure Blob Storage. The file depicts the rclone configuration found among other files owned by FIN7 (see Figure 41).Figure 41. The rclone configuration file used in the data exfiltrations.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.35 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gang5 Setting up the full picture : Additional COMINT FindingsThe COMINT findings presented in this section are a valuable addition to the intelligence previously gathered. These conversations have provided a wealth of evidence and insight into the actions and motivations of the FIN7 threat actors. By closely analyzing this information, the PTI team has been able to accurately identify the roles of each member and gain a thorough understanding of the inner workings of the group. This information will be crucial in informing future assessments and strategies for combating FIN7.5.1 Multiple Ransomware AffiliationsIn alignment with the findings, FIN7 members have also been cooperating with a person nicknamed as Rash, who is a head of the locker team. These members are not only affiliated with REvil and LockBit but they also talk about another REvil team that stole information from a Covid-19 Research Firm in 2020.Figure 42. Relations with the REvil ransomware team.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.36 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangIn May, 2020, the affiliates of Revil attacked the FARO Technologies company and posted the company data on their site for public access with Happy Blog name. 7 This incident has been detected in their dialogues due to the investigation led by our analysts. In addition to getting the victim’s files illegally, they also encrypted the files accessible in their network.Figure 43. Conversation about the incident of FARO Technologies.7. url : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.37 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangNotably, one of the ransom methods in terms of online communication applied by the REvil group is to call the victim on the telephone. These calls are conducted by specially trained experts who have an excellent command of English language and therefore sound more credible.Figure 44. Conversation about the incident of FARO Technologies.In April, 2020, a group of REvil affiliates attacked Travelex company and managed to receive a ransom from this victim, which was around 2.3 million dollars. 8 This incident is also disclosed in the FIN7 group dialogues.Figure 45. Conversation about the incident of Travelex.8. url : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.38 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangThe correspondence provided below that happened between the threat actors precisely displays their communication with the victim of Lockbit Ransomware. As such, the victim indicates that their company has already been infected by REvil’s locker.Figure 46. Relations with REvil and LockBit ransomware teams.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.39 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangThe Darkside Ransomware team started to attack large companies from more than 15 countries in August 2020. These companies included law firms, financial services, manufacturing factories and information technologies. Thereupon, the Darkside Ransomware group was responsible for the infamous Colonial Pipeline attack in May 2021. The attack led the company to actively and temporarily close the 5500 mile pipelines which in fact carry approximately 45 percent of fuel used on the east coast of United States. 9 It is noteworthy to mention that the Darkside group appeared, FIN7 members touched upon the news about this group in their conversations.Figure 47. Conversation about the Darkside Ransomware.To further confirm the connection, a text file named darkside_readme.txt was discovered in the infrastructure of the FIN7 team.Figure 48. Relations with the Darkside Ransomware.9. url : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.40 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangInitially, based on further PTI discoveries, there was a discussion led by FIN7 about the payments that each member receives from the operation. It has been evaluated that from the amount they receive ; 25% goes to the ransomware owner, 20% to authentication data of the victim’s network, and the highest amount is received by the head of the team who deals with ransomware (nickname : Rash). The rest of the money is distributed among the group members, as indicated in Figure 49Figure 49. Profit From Ransomware.Figure 50. Profit From Ransomware.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.41 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangAccording to the given correspondence among the members, the head of FIN7 decided to engage in ransomware operations since the POS machines do not bring enough income to satisfy the members.Figure 51. Conversation about the ransomware operations.Figure 52. Conversation about the ransomware operations.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.42 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangFigure 53. Conversation about the ransomware operations.Figure 54. Conversation about the ransomware operations.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.43 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangTo keep the money flowing in, FIN7 members also sell victims’ credit card information to third parties. As it occurs, they sell the credit card details after the victim pays the ransom for encrypted information, as seen in Figure 55Figure 55. Conversation about the selling stolen credit cards.Ransomware victims normally pay the ransom cost in Bitcoin or Monero cryptocurrencies. In order to protect themselves while exchanging those cryptocurrencies for another currency type, they use specific services to get them in cash. Eventually, the obtained money is delivered to the threat actors by a courier service as they try to remain inconspicuous ; so the delivery usually takes place when they are in a crowded place.Figure 56. Conversation about the cashout techniques.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.44 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gang5.2 Victim Re-targetingIntending to get into the victim’s network, and subsequently encrypt servers and computers, the threat actors use the access that had been sold on particular internet markets - those that are specialising in selling stolen victim data. The stolen data are mostly obtained from the victims’ computers, or exploiting vulnerabilities in the victim’s network. Once the threat actors have gained access to a victim’s network, they typically install backdoors to facilitate their ransomware attacks and ensure they are able to collect ransom payments. After the attack is complete, the group may resell or reuse the access they have gained to launch additional attacks. Even if the victim takes steps to remove the initial vulnerabilities, the existing backdoors can continue to provide a means for future infections. This allows the threat actors to repeatedly target the same victim, potentially causing significant damage and disruption.Figure 57. Re-targeting the Victims.From the text messages that have been acquired it is clear that the exact same actor firstly uses the malware Sodinokibi, which belongs to REvil. However, after a while, the LockBit ransomware is used on the same victim (see Figure 57).DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.45 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gang5.3 Internal Threatening and Member IntimidationAnother shocking revelation clearly indicates that the group members are not always on good terms among themselves. It has been exposed that the administrator of the group threatens the team members by insisting that they have to work more while giving them ultimatums or even threatening to hurt their family members in case of resigning or escaping from responsibilities. The conversation excerpts illustrating those practices are found in the figures below.Figure 58. Threatening Team Members.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.46 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangFigure 59. Threatening Team Members.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.47 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gang6 Statistics and ObservationsThe analysis of the FIN7 group reaffirms the occurrence of substantially severe infections worldwide, whilst in almost all cases, the targets are only enterprise-level corporations. Our PTI team has correlated these victim details gleaned from multiple affiliate accounts and servers to provide insight into some of FIN7’s behavioural patterns, workflows, and activity timelines.Figure 60. Victim distribution of the FIN7 group.During the investigation, The PTI team identified more than 8,147 FIN7 victims across the globe, and the majority of victims commonly originated from USA 16.74%. It has been observed that threat actors often target victims from Russia at a high rate. However, none of these victims is encountered in the later stages of the attack cycle. This may be because the attackers are opportunistically targeting a large number of victims and then filtering them based on certain criteria. As a result, only a small portion of the initial group of victims are actually affected by the attack. All details regarding the victims’ origins are depicted in Figure 60.In addition to mass-scale exploitation and spear-phishing attacks, the FIN7 group has also been observed using VPN or RDP credentials obtained from underground markets to gain unauthorized access to victims’ systems. We strongly recommend that organizations take steps to protect themselves, such as by implementing strong authentication measures like MFA (Multi-Factor Authentication), fixing public vulnerabilities, and regularly monitoring for suspicious activity.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.48 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gang7 ConclusionThis report has provided detailed information and unparalleled insights into one of the notorious threat groups in the cybercrime industry. FIN7 has established itself as an extraordinarily versatile and well-known APT group that targets enterprise companies. Before diving into technical analysis and their attack tactics, techniques and procedures, the key members’ organizational structure and clear hierarchy have been described in further detail. As has been steadily outlined throughout the report, FIN7 uses various techniques to obtain the data they are looking for - with the aim to monetize them afterwards. Some of those techniques include utilizing public exploits, buying stolen credentials from underground markets, cooperating with other ransomware groups, or using social engineering methods such as distributing malware through malicious USBs and sending spear-phishing emails.Despite increased detection solutions and awareness within the targeted sectors, utilizing public exploits is a powerful approach for gaining access to the victims’ systems. To this date, the FIN7 group compromised and caused monetary damage to 8,147 victims, predominantly residing in the USA (16.74%). It is essential to mention that they managed to infiltrate all those high-profile companies after scanning 1,826,508 targets.This report provides a comprehensive overview of the toolkits and strategies used by the FIN7 hacking group. By analyzing these tactics, we can identify potential defenses against their attacks and aid the intelligence community in their efforts to protect against future incidents. It is important to note that these attacks are carefully coordinated to maximize their impact before industry-wide information sharing and countermeasures are implemented. By understanding the methods used by FIN7, we can take steps to better protect ourselves and our organizations.Ultimately, the report elaborates on the FIN7 attack activities and techniques that are unfortunately gaining popularity in the cybercrime market. The attackers have been motivated by the vision of financial gains since 2013. As the report confirmed, their signature move is to thoroughly research the companies based on their revenue, employee count, headquarters and website information to pinpoint the most profitable targets. Although they have internal issues related to the unequal distribution of obtained monetary resources and somewhat questionable practices towards their members, they have managed to establish a strong presence in the cybercrime sphere. They are a highly structured criminal organization, as demonstrated by their previous campaigns and comparison with other hacking groups. They conduct their operations with an exceptionally good access to resources ranging from financial services to software and valuable networks.DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.49 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangAcknowledgement We would like to thank our advisors for their valuable guidance and support throughout this research.The public version of the report will be shared from our github page 10. The readers can find new samples, IOCs, and new versions of this report from our github page as we will constantly update our page based on new findings.10. url : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of 2cedhihsepjtcpwuwes77cle5wb6ml7e5ys6ivsb4a4ivlrw2vc4wwad.onionDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of 4r7hlqzkxl5xtjxn.onionDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.57 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangRéférences[1] CISA. Active Exploitation of ProxyShell Vulnerabilities. url : url uscert / ncas / current - activity / 2021 / 08 / 21 / urgent - protect - against - active - exploitation-proxyshell. (accessed : 30.07.2022).[2] Horizon3. Proof of Concept Exploit for Microsoft Exchange. url : url (accessed : 30.07.2022).[3] Mandiant. FIN7 Power Hour : Adversary Archaeology and the Evolution of FIN7. url : url (accessed : 15.12.2022).[4] Microsoft. April 2021 Exchange Server Security Updates. url : url microsoft.com/t5/exchange-team-blog/released-april-2021-exchange-server- security-updates/ba-p/2254617. (accessed : 30.07.2022).[5] The Record. Cybercrime gang sets up fake company to hire security experts to aid in ransomware attacks. url : url company-to-hire-security-experts-to-aid-in-ransomware-attacks/. (accessed : 15.12.2022).[6] CISCO TALOS. Active Exploitation of ProxyShell Vulnerabilities. url : https : / / blog . talosintelligence . com / 2021 / 11 / babuk - exploits - exchange . html. (accessed : 30.07.2022).[7] TRUESEC. ProxyShell, QBot, and Conti Ransomware Combined in a Series of Cyber Attacks. url : url ransomware-combined-in-a-series-of-cyber-attacks. (accessed : 30.07.2022).[8] Wikipedia. Carbanak. url : url (accessed :15.12.2022).DISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.58 / 59TLP:CLEARFIN7 Unveiled : A deep dive into notorious cybercrime gangHistoriqueVersion Date 1.3Auteur(s) 30.07.2022 PTI Team PTI Team 18.09.2022 PTI Team 15.12.2022 22.12.2022 PTI TeamModifications Initial TLP:RED DRAFT release Updated TLP:RED version for LE TLP:AMBER version TLP:CLEAR versionDISCLAIMER : This document and its contents shall be deemed as proprietary and privileged information of PRODAFT and shall be subjected to articles and provisions that have been stipulated in the General Data Protection Regulation and Personal Data Protection Law. It shall be noted that PRODAFT provides this information “as is” according to its findings, without providing any legally applicable warranty regarding completeness or accuracy of the contents. Therefore, neither this report nor any of its contents can be used as admissible proof before legal authorities.
